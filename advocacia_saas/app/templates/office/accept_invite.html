{% extends "base.html" %}

{% block content %}
<!-- Page Header -->
<div class="breadcrumb-custom">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}">Dashboard</a></li>
                        <li class="breadcrumb-item active">Convite para Escritório</li>
                    </ol>
                </nav>
                <h1 class="text-white mt-2 mb-0">
                    <i class="fas fa-envelope-open me-2"></i>Convite para Escritório
                </h1>
            </div>
        </div>
    </div>
</div>

<div class="container my-5 content-wrapper">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="dashboard-card">
                <div class="card-body text-center p-5">
                    <!-- Office Logo/Icon -->
                    <div class="mb-4">
                        {% if office.logo_filename %}
                        <img src="{{ url_for('static', filename='uploads/' + office.logo_filename) }}" 
                             alt="{{ office.name }}" class="img-fluid rounded" style="max-height: 80px;">
                        {% else %}
                        <div class="display-1 text-primary">
                            <i class="fas fa-building"></i>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Invite Details -->
                    <h2 class="mb-3">{{ office.name }}</h2>
                    
                    <p class="lead mb-4">
                        <strong>{{ inviter.full_name or inviter.username }}</strong> convidou você para 
                        fazer parte do escritório como <strong>{{ role_info.get('name', invite.role) }}</strong>.
                    </p>
                    
                    {% if role_info.get('description') %}
                    <div class="alert alert-info text-start mb-4">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>{{ role_info.get('name') }}:</strong> {{ role_info.get('description') }}
                    </div>
                    {% endif %}
                    
                    <!-- Office Info -->
                    {% if office.email or office.phone %}
                    <div class="text-muted mb-4">
                        {% if office.email %}
                        <small><i class="fas fa-envelope me-1"></i>{{ office.email }}</small>
                        {% endif %}
                        {% if office.phone %}
                        <small class="ms-3"><i class="fas fa-phone me-1"></i>{{ office.phone }}</small>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-center gap-3">
                        <form action="{{ url_for('office.decline_invite', token=invite.token) }}" method="POST">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-outline-secondary btn-lg">
                                <i class="fas fa-times me-2"></i>Recusar
                            </button>
                        </form>
                        
                        <form action="{{ url_for('office.accept_invite', token=invite.token) }}" method="POST">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-check me-2"></i>Aceitar Convite
                            </button>
                        </form>
                    </div>
                    
                    <!-- Expiration Warning -->
                    {% if invite.expires_at %}
                    <div class="mt-4">
                        <small class="text-muted">
                            <i class="fas fa-clock me-1"></i>
                            Este convite expira em {{ invite.expires_at|local_datetime('%d/%m/%Y às %H:%M') }}
                        </small>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
